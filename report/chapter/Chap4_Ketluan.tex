\clearpage
\phantomsection

\setcounter{chapter}{4}
\chapter[{ĐÁNH GIÁ VÀ PHÂN TÍCH KẾT QUẢ}]{Đánh giá và phân tích kết quả}

Chương này trình bày chi tiết về thiết lập thực nghiệm, kết quả chính, phân tích sâu sắc, so sánh với các phương pháp khác, và giới hạn của đề tài.

\section{Thiết lập thực nghiệm}

\subsection{Môi trường thực nghiệm}

\begin{itemize}
	\item \textbf{Blockchain}: Sui Testnet (mainnet-v1.18.0)
	\item \textbf{Hardware}:
		\begin{itemize}
			\item CPU: Intel Core i7-10700K (8 cores)
			\item RAM: 32GB DDR4
			\item Storage: 500GB NVMe SSD
			\item Network: 1Gbps connection
		\end{itemize}
	\item \textbf{Software}:
		\begin{itemize}
			\item OS: Ubuntu 22.04 LTS
			\item Rust: 1.75.0
			\item PostgreSQL: 15.2
			\item Elasticsearch: 8.11.0
			\item Kibana: 8.11.0
		\end{itemize}
\end{itemize}

\subsection{Test Protocol Specifications}

\textbf{Move Contracts Code Summary}:

\begin{itemize}
	\item \textbf{Pool Contract}: 
		\begin{itemize}
			\item Functions: \texttt{swap}, \texttt{add\_liquidity}, \texttt{remove\_liquidity}
			\item Events: \texttt{SwapExecuted}, \texttt{LiquidityAdded}
			\item Initial liquidity: \$100,000 USDC
		\end{itemize}
	
	\item \textbf{Token Contract}:
		\begin{itemize}
			\item Standard Sui Coin implementation
			\item Total supply: 1,000,000 tokens
		\end{itemize}
	
	\item \textbf{Lending Contract}:
		\begin{itemize}
			\item Functions: \texttt{borrow}, \texttt{repay}, \texttt{liquidate}
			\item Oracle integration: Price feed từ Pool
			\item Health Factor calculation
		\end{itemize}
\end{itemize}

\textbf{Pool Configurations}:

\begin{itemize}
	\item Pool A: USDC/SUI (Liquidity: \$100k)
	\item Pool B: USDC/ETH (Liquidity: \$50k)
	\item Pool C: SUI/ETH (Liquidity: \$30k)
\end{itemize}

\textbf{Token Parameters}:

\begin{itemize}
	\item USDC: Stablecoin, 1:1 với USD
	\item SUI: Native token, volatile price
	\item ETH: Wrapped Ethereum, volatile price
\end{itemize}

\subsection{Attack Scenarios được sử dụng}

\begin{enumerate}
	\item \textbf{Flash Loan Attack} (10 test cases):
		\begin{itemize}
			\item Input: Vay \$10k-\$100k, exploit trong callback
			\item Expected Output: Risk score CRITICAL, alert triggered
		\end{itemize}
	
	\item \textbf{Oracle Manipulation} (10 test cases):
		\begin{itemize}
			\item Input: Large swap để manipulate price, trigger liquidation
			\item Expected Output: Risk score HIGH, price deviation detected
		\end{itemize}
	
	\item \textbf{Sandwich Attack} (15 test cases):
		\begin{itemize}
			\item Input: Front-run + victim + back-run pattern
			\item Expected Output: Risk score HIGH, MEV extraction detected
		\end{itemize}
	
	\item \textbf{Behavioral Anomaly} (8 test cases):
		\begin{itemize}
			\item Input: Account với behavior bất thường (>3$\sigma$ từ baseline)
			\item Expected Output: Risk score MEDIUM-HIGH, anomaly detected
		\end{itemize}
\end{enumerate}

\subsection{Metrics được đánh giá}

\begin{itemize}
	\item \textbf{Detection Rate (DR)}: Tỷ lệ tấn công được phát hiện
		\begin{equation}
		\text{DR} = \frac{\text{True Positives}}{\text{True Positives + False Negatives}}
		\end{equation}
	
	\item \textbf{False Positive Rate (FPR)}: Tỷ lệ báo động sai
		\begin{equation}
		\text{FPR} = \frac{\text{False Positives}}{\text{False Positives + True Negatives}}
		\end{equation}
	
	\item \textbf{Detection Latency}: Thời gian từ khi tấn công xảy ra đến khi được phát hiện
	
	\item \textbf{Throughput}: Số lượng transactions có thể xử lý mỗi giây
	
	\item \textbf{Memory Usage}: Mức sử dụng bộ nhớ của hệ thống
\end{itemize}

\subsection{Baseline và Comparison}

\begin{itemize}
	\item \textbf{So sánh với từng analyzer riêng lẻ}: Đánh giá hiệu quả của multi-signal approach so với single-signal
	
	\item \textbf{So sánh Custom Indexer vs ELK only}: Đánh giá lợi ích của dual-layer architecture
	
	\item \textbf{So sánh với Forta Network}: So sánh detection capabilities và latency
\end{itemize}

\section{Kết quả chính}

\subsection{Detection Performance (Định lượng)}

\textbf{Overall Detection Rate}: 91\% ± 5\%

Kết quả chi tiết theo từng loại tấn công:

\begin{itemize}
	\item \textbf{Flash Loan}: 100\% (10/10 test cases)
		\begin{itemize}
			\item Tất cả flash loan exploits đều được phát hiện
			\item Pattern rõ ràng, dễ nhận biết
			\item False positive: 0\%
		\end{itemize}
	
	\item \textbf{Oracle Manipulation}: 90\% (9/10 test cases)
		\begin{itemize}
			\item 1 test case bị bỏ sót do price deviation nhỏ (<5\%)
			\item False positive: 5\% (do volatility tự nhiên của thị trường)
		\end{itemize}
	
	\item \textbf{Sandwich}: 95\% (14/15 test cases)
		\begin{itemize}
			\item 1 test case bị bỏ sót do pattern không rõ ràng
			\item False positive: 3\% (do legitimate MEV extraction)
		\end{itemize}
	
	\item \textbf{Behavioral}: 75\% (6/8 test cases)
		\begin{itemize}
			\item 2 test cases bị bỏ sót do baseline chưa đủ dữ liệu
			\item False positive: 10\% (do legitimate behavior changes)
		\end{itemize}
\end{itemize}

\textbf{Bảng chi tiết test cases}:

\begin{table}[!h]
\centering
\caption{Chi tiết Detection Performance}
\resizebox{1\hsize}{!} {
\begin{tabular}{|l|c|c|c|c|c|}
\hline
\rowcolor[rgb]{1,0.925,0.918}
\textbf{Attack Type} & \textbf{Total} & \textbf{Detected} & \textbf{Missed} & \textbf{FP} & \textbf{DR} \\
\hline
Flash Loan & 10 & 10 & 0 & 0 & 100\% \\
\hline
Oracle Manipulation & 10 & 9 & 1 & 0.5 & 90\% \\
\hline
Sandwich & 15 & 14 & 1 & 0.45 & 95\% \\
\hline
Behavioral & 8 & 6 & 2 & 0.8 & 75\% \\
\hline
\textbf{Total} & \textbf{43} & \textbf{39} & \textbf{4} & \textbf{1.75} & \textbf{91\%} \\
\hline
\end{tabular}
}
\label{tab:detailed_performance}
\end{table}

\subsection{System Performance (Tối ưu hóa)}

\textbf{Latency Metrics}:

\begin{itemize}
	\item \textbf{Real-time detection} (Custom Indexer): 1-2 giây
		\begin{itemize}
			\item Flash Loan: 1.8s trung bình
			\item Oracle: 2.5s trung bình
			\item Sandwich: 1.5s trung bình
		\end{itemize}
	
	\item \textbf{Historical analysis} (ELK): <5 giây
		\begin{itemize}
			\item Behavioral analysis: 8.3s trung bình
			\item Query response: <500ms
		\end{itemize}
	
	\item \textbf{Alert generation}: <1 giây
\end{itemize}

\textbf{Throughput}: 1,000+ transactions/giây

\begin{itemize}
	\item Tested với 10k-100k transactions
	\item Không có degradation đáng kể
	\item Có thể scale horizontal bằng cách thêm indexer instances
\end{itemize}

\textbf{Resource Usage}:

\begin{itemize}
	\item \textbf{Memory}: 2-4GB (tùy workload)
		\begin{itemize}
			\item Custom Indexer: 500MB-1GB
			\item PostgreSQL: 200MB-500MB
			\item Elasticsearch: 1.5GB-2.5GB
		\end{itemize}
	
	\item \textbf{CPU}: 15-25\% (8 cores)
		\begin{itemize}
			\item Chủ yếu từ Elasticsearch indexing
			\item Custom Indexer: 5-10\%
		\end{itemize}
	
	\item \textbf{Disk}: 50GB cho 1 triệu transactions
		\begin{itemize}
			\item Elasticsearch: 40GB
			\item PostgreSQL: 5GB
			\item Logs: 5GB
		\end{itemize}
\end{itemize}

\subsection{Risk Scoring Accuracy}

\textbf{Precision \& Recall cho mỗi risk level}:

\begin{table}[!h]
\centering
\caption{Risk Scoring Accuracy}
\resizebox{1\hsize}{!} {
\begin{tabular}{|l|c|c|c|}
\hline
\rowcolor[rgb]{1,0.925,0.918}
\textbf{Risk Level} & \textbf{Precision} & \textbf{Recall} & \textbf{F1-Score} \\
\hline
LOW & 0.98 & 0.95 & 0.96 \\
\hline
MEDIUM & 0.85 & 0.80 & 0.82 \\
\hline
HIGH & 0.90 & 0.88 & 0.89 \\
\hline
CRITICAL & 0.95 & 0.92 & 0.93 \\
\hline
\end{tabular}
}
\label{tab:risk_scoring_accuracy}
\end{table}

\textbf{Comparison: Multi-signal vs Single-signal}:

\begin{itemize}
	\item \textbf{Multi-signal approach}: F1-score = 0.90
	\item \textbf{Single-signal (chỉ Flash Loan)}: F1-score = 0.75
	\item \textbf{Improvement}: +20\% accuracy
\end{itemize}

\section{Phân tích kết quả (In-depth Analysis)}

\subsection{Đánh giá từng analyzer}

\textbf{Oracle Analyzer}:

\begin{itemize}
	\item \textbf{Strengths}:
		\begin{itemize}
			\item Real-time detection, low latency (2.5s)
			\item Phát hiện được price manipulation rõ ràng
			\item Tích hợp tốt với Health Factor monitoring
		\end{itemize}
	
	\item \textbf{Weaknesses}:
		\begin{itemize}
			\item High false positive rate (5\%) trên volatile markets
			\item Khó phân biệt manipulation và volatility tự nhiên
		\end{itemize}
	
	\item \textbf{Solution}:
		\begin{itemize}
			\item Điều chỉnh thresholds dựa trên market conditions
			\item Sử dụng multiple timeframes cho TWAP calculation
		\end{itemize}
\end{itemize}

\textbf{Flash Loan Analyzer}:

\begin{itemize}
	\item \textbf{Strengths}:
		\begin{itemize}
			\item Perfect detection rate (100\%)
			\item Pattern matching rất hiệu quả
			\item Stateful tracking cho phép theo dõi toàn bộ loan lifecycle
		\end{itemize}
	
	\item \textbf{Weaknesses}:
		\begin{itemize}
			\item Chỉ phát hiện được flash loans rõ ràng
			\item Có thể bỏ sót các flash loans phức tạp hơn
		\end{itemize}
	
	\item \textbf{Improvements}:
		\begin{itemize}
			\item Thêm pattern recognition cho complex flash loan structures
			\item Machine learning để phát hiện subtle patterns
		\end{itemize}
\end{itemize}

\textbf{Sandwich Analyzer}:

\begin{itemize}
	\item \textbf{Challenges}:
		\begin{itemize}
			\item MEV complexity: Khó phân biệt legitimate và malicious MEV
			\item Pattern có thể thay đổi tùy theo blockchain architecture
		\end{itemize}
	
	\item \textbf{Current Performance}:
		\begin{itemize}
			\item Detection rate: 95\%
			\item False positive: 3\%
		\end{itemize}
	
	\item \textbf{Improvements}:
		\begin{itemize}
			\item Machine learning để học patterns
			\item Tích hợp với mempool data (nếu có)
		\end{itemize}
\end{itemize}

\textbf{Price Analyzer}:

\begin{itemize}
	\item \textbf{Metric Selection Analysis}:
		\begin{itemize}
			\item Trade-to-liquidity ratio: Hiệu quả trong phát hiện large trades
			\item Price impact: Tốt cho phát hiện manipulation
		\end{itemize}
	
	\item \textbf{Threshold Tuning Results}:
		\begin{itemize}
			\item Optimal price impact threshold: 5\%
			\item Optimal trade-to-liquidity ratio: 0.1 (10\%)
		\end{itemize}
\end{itemize}

\subsection{Risk Scoring Algorithm Effectiveness}

\textbf{Weight Distribution Analysis}:

\begin{itemize}
	\item \textbf{Flash Loan (0.35)}: Có impact lớn nhất vì flash loan exploits thường gây tổn thất lớn
	\item \textbf{Oracle (0.30)}: Quan trọng vì oracle manipulation ảnh hưởng nhiều protocols
	\item \textbf{Sandwich (0.20)}: MEV extraction phổ biến nhưng ít gây tổn thất trực tiếp
	\item \textbf{Price (0.15)}: Hỗ trợ cho các analyzer khác
\end{itemize}

\textbf{Threshold Analysis}:

\begin{itemize}
	\item \textbf{Optimal ALERT\_THRESHOLD}: 60
		\begin{itemize}
			\item Balance giữa false positive và false negative
			\item Đủ nhạy để phát hiện threats nhưng không quá nhiều alerts
		\end{itemize}
	
	\item \textbf{CRITICAL threshold}: 80
		\begin{itemize}
			\item Chỉ trigger cho các tấn công nghiêm trọng nhất
			\item False positive rate rất thấp (<1\%)
		\end{itemize}
\end{itemize}

\textbf{False Negative Analysis}:

\begin{itemize}
	\item \textbf{Missed Attacks}:
		\begin{itemize}
			\item 1 Oracle Manipulation: Price deviation nhỏ (<5\%)
			\item 1 Sandwich: Pattern không rõ ràng
			\item 2 Behavioral: Baseline chưa đủ dữ liệu
		\end{itemize}
	
	\item \textbf{Reasons}:
		\begin{itemize}
			\item Thresholds quá cao
			\item Pattern mới chưa được nhận biết
			\item Thiếu dữ liệu lịch sử
		\end{itemize}
\end{itemize}

\textbf{False Positive Analysis}:

\begin{itemize}
	\item \textbf{Legitimate TXs bị flag}:
		\begin{itemize}
			\item Large legitimate swaps (bị nhầm với manipulation)
			\item Legitimate MEV extraction (bị nhầm với sandwich)
			\item Behavior changes hợp pháp (bị nhầm với compromised)
		\end{itemize}
	
	\item \textbf{Solutions}:
		\begin{itemize}
			\item Whitelist các addresses đáng tin cậy
			\item Context-aware analysis
			\item Human review cho borderline cases
		\end{itemize}
\end{itemize}

\subsection{Trade-offs: Detection vs Performance}

\textbf{Increasing Sensitivity → More FP}:

\begin{itemize}
	\item Nếu giảm thresholds để tăng detection rate:
		\begin{itemize}
			\item Detection rate tăng: 91\% → 95\%
			\item False positive tăng: 4.5\% → 8\%
		\end{itemize}
	
	\item Cần balance dựa trên use case:
		\begin{itemize}
			\item High-security protocols: Ưu tiên detection rate
			\item User-facing apps: Ưu tiên giảm false positive
		\end{itemize}
\end{itemize}

\textbf{Real-time vs Accuracy}:

\begin{itemize}
	\item Real-time detection (1-2s): 
		\begin{itemize}
			\item Pros: Phản ứng nhanh
			\item Cons: Có thể bỏ sót các pattern phức tạp
		\end{itemize}
	
	\item Historical analysis (5-30s):
		\begin{itemize}
			\item Pros: Phát hiện được các pattern phức tạp
			\item Cons: Độ trễ cao hơn
		\end{itemize}
	
	\item Solution: Dual-layer architecture kết hợp cả hai
\end{itemize}

\textbf{Storage vs Query Speed}:

\begin{itemize}
	\item Lưu trữ nhiều dữ liệu:
		\begin{itemize}
			\item Pros: Phân tích sâu hơn
			\item Cons: Query chậm hơn, tốn storage
		\end{itemize}
	
	\item Index rotation strategy:
		\begin{itemize}
			\item Hot storage (90 days): Fast queries
			\item Cold storage (archive): Slower queries nhưng tiết kiệm
		\end{itemize}
\end{itemize}

\subsection{Lessons Learned}

\textbf{What Worked Well}:

\begin{itemize}
	\item Dual-layer architecture: Kết hợp real-time và historical analysis rất hiệu quả
	\item Multi-signal risk scoring: Giảm false positive đáng kể
	\item Stateful tracking: Cho phép phát hiện các tấn công phức tạp
	\item Elasticsearch DSL: Mạnh mẽ cho complex queries
\end{itemize}

\textbf{What Didn't Work}:

\begin{itemize}
	\item Stateless detection: Không đủ cho flash loan tracking
	\item Single-signal approach: False positive cao
	\item Fixed thresholds: Không adapt với market conditions
\end{itemize}

\textbf{Unexpected Challenges}:

\begin{itemize}
	\item Sui Testnet có throughput thấp hơn expected
	\item Event parsing phức tạp hơn do Object-Centric model
	\item Behavioral analysis cần nhiều dữ liệu hơn dự kiến
\end{itemize}

\textbf{Solutions Found}:

\begin{itemize}
	\item Batch processing để tối ưu throughput
	\item Custom parsers cho Sui events
	\item Statistical methods để giảm yêu cầu dữ liệu cho behavioral analysis
\end{itemize}

\section{So sánh với các phương pháp khác}

\subsection{So sánh với Forta Network}

\begin{table}[!h]
\centering
\caption{So sánh với Forta Network}
\resizebox{1\hsize}{!} {
\begin{tabular}{|l|l|l|}
\hline
\rowcolor[rgb]{1,0.925,0.918}
\textbf{Feature} & \textbf{MDRDS} & \textbf{Forta Network} \\
\hline
Architecture & Dual-layer (Indexer + ELK) & Distributed bots \\
\hline
Detection Capabilities & 4 attack types & Varies by bot \\
\hline
Latency & 1-5s & 30s-5min \\
\hline
Scalability & 1,000+ TX/s & Limited by bot performance \\
\hline
Sui Support & Native & Limited \\
\hline
Behavioral Analysis & Yes & No \\
\hline
Cost & Self-hosted & Subscription-based \\
\hline
\end{tabular}
}
\label{tab:forta_comparison}
\end{table}

\textbf{Ưu điểm của MDRDS}:
\begin{itemize}
	\item Lower latency
	\item Native Sui support
	\item Behavioral analysis
	\item More control và customization
\end{itemize}

\textbf{Ưu điểm của Forta}:
\begin{itemize}
	\item Distributed network
	\item Community-driven bots
	\item Established ecosystem
\end{itemize}

\subsection{So sánh với CertiK Monitoring}

\begin{itemize}
	\item \textbf{Coverage Differences}:
		\begin{itemize}
			\item MDRDS: Real-time monitoring + historical analysis
			\item CertiK: Contract audit + periodic monitoring
		\end{itemize}
	
	\item \textbf{Accuracy Metrics}:
		\begin{itemize}
			\item MDRDS: 91\% detection rate, 4.5\% FP
			\item CertiK: Không công bố public metrics
		\end{itemize}
	
	\item \textbf{Ease of Use}:
		\begin{itemize}
			\item MDRDS: Open-source, self-hosted
			\item CertiK: Commercial service, requires subscription
		\end{itemize}
\end{itemize}

\subsection{Ưu điểm của MDRDS}

\begin{enumerate}
	\item \textbf{Dual-layer architecture advantage}:
		\begin{itemize}
			\item Kết hợp real-time và historical analysis
			\item Tận dụng ưu điểm của cả hai approaches
		\end{itemize}
	
	\item \textbf{Multi-signal scoring}:
		\begin{itemize}
			\item Giảm false positive
			\item Tăng accuracy
		\end{itemize}
	
	\item \textbf{Behavioral analysis depth}:
		\begin{itemize}
			\item Phát hiện compromised accounts
			\item Phân tích patterns phức tạp
		\end{itemize}
	
	\item \textbf{Native Sui support}:
		\begin{itemize}
			\item Tối ưu cho Object-Centric model
			\item Tận dụng TX-DAG structure
		\end{itemize}
\end{enumerate}

\subsection{Nhược điểm và cơ hội cải thiện}

\begin{itemize}
	\item \textbf{Limited to Sui}:
		\begin{itemize}
			\item Chưa support các blockchain khác
			\item Cần adapt cho từng blockchain
		\end{itemize}
	
	\item \textbf{Off-chain attack detection limitations}:
		\begin{itemize}
			\item Khó phát hiện nếu hacker không reuse address
			\item Cần thêm dữ liệu off-chain
		\end{itemize}
	
	\item \textbf{ML integration potential}:
		\begin{itemize}
			\item Có thể cải thiện accuracy với ML
			\item Adaptive thresholds
			\item Pattern learning
		\end{itemize}
\end{itemize}

\section{Giới hạn của đề tài}

\begin{enumerate}
	\item \textbf{Chỉ test trên Sui Testnet}:
		\begin{itemize}
			\item Mainnet có thể có behavior khác
			\item Throughput và latency có thể khác
		\end{itemize}
	
	\item \textbf{Giới hạn số lượng protocols}:
		\begin{itemize}
			\item Chỉ test với 3-5 protocols
			\item Có thể không cover hết các edge cases
		\end{itemize}
	
	\item \textbf{Giới hạn loại attack}:
		\begin{itemize}
			\item Focus vào 4 main types
			\item Có thể có các attack vectors mới chưa được cover
		\end{itemize}
	
	\item \textbf{False positive rate}:
		\begin{itemize}
			\item Vẫn còn 4-5\% false positive
			\item Cần human review cho một số cases
		\end{itemize}
	
	\item \textbf{Behavioral analysis latency}:
		\begin{itemize}
			\item 5-30 giây (vs realtime detection 1-2s)
			\item Cần nhiều dữ liệu lịch sử
		\end{itemize}
	
	\item \textbf{Off-chain attacks}:
		\begin{itemize}
			\item Khó phát hiện nếu hacker không reuse address
			\item Cần thêm dữ liệu off-chain (IP, device fingerprint, etc.)
		\end{itemize}
\end{enumerate}
